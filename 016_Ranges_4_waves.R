#=============
# 28 Nov. 2023
#=============

# Aim:
  # compare wave_v4, v5, v6, v7
  # v4: decay = 1/2, // < 2//
  # v7: decay = 2, // < 2//

  # v5: decay = 2, // < //
  # v6: decay = 1/2, // < //

  # v8: decay = 2.5, // < //
  # v8new: decay = 2, // < 1/2//
  

  # observe the maganitude of their negative values

#--------
# Domain
#--------
ds <- 0.1
s <- seq(-1 + ds/2, 1 - ds/2, by = ds)

# for 3D requires displacement
H <- t(outer(s, s, "-"))

#------------
# Range check
#------------
source("Fn_Waves.R")

cat("wave_v8nw", "\n")
cat("wave_v9", "\n")
cat("wave_v8", "\n")
cat("wave_v7", "\n")
cat("wave_v4", "\n")
cat("wave_v5", "\n")
cat("wave_v6", "\n")
DELTA <- c(-0.7, -0.3, -0.1, 0.1, 0.3, 0.5, 0.7, 1)
R <- matrix(NA, ncol = 6)
for (delta in DELTA){
  
  #w9 <- wave_v9(h = H, delta = delta, A = 1)
  w8 <- wave_v8(h = H, delta = delta, A = 1)
  #w7 <- wave_v7(h = H, delta = delta, A = 1)
  #w4 <- wave_v4(h = H, delta = delta, A = 1)
  #w5 <- wave_v5(h = H, delta = delta, A = 1)
  #w6 <- wave_v6(h = H, delta = delta, A = 1)
  
  #r <- range(w6)
  q <- quantile(w8)
  dq <- t(c(delta, q))
  
  R <- rbind(R, dq)
}
R
colnames(R) <- c("delta", "min", "25%", "50%", "75%", "max")


# wave_v9 same as wave_v8new
#           0% 25% 50% 75% 100%
#[1,]   NA NA  NA  NA  NA   NA
#[2,] -0.7  0   0   0   0    1
#[3,] -0.3  0   0   0   0    1
#[4,] -0.1  0   0   0   0    1
#[5,]  0.1  0   0   0   0    1
#[6,]  0.3  0   0   0   0    1
#[7,]  0.5  0   0   0   0    1
#[8,]  0.7  0   0   0   0    1
#[9,]  1.0  0   0   0   0    1





# wave_v8
#     delta        min 25% 50%       75% max
#[1,]    NA         NA  NA  NA        NA  NA
#[2,]  -0.7 -0.8367347   0   0 0.1836735   1
#[3,]  -0.3 -1.5000000   0   0 0.0000000   1
#[4,]  -0.1 -1.5000000   0   0 0.0000000   1
#[5,]   0.1 -1.5000000   0   0 0.0000000   1
#[6,]   0.3 -1.5000000   0   0 0.0000000   1
#[7,]   0.5 -1.5000000   0   0 0.1000000   1
#[8,]   0.7 -0.8367347   0   0 0.1836735   1
#[9,]   1.0 -1.0250000   0   0 0.3750000   1










#R[-1, ]

# wave_v7
#              0%       25% 50%       75% 100%
#[1,]   NA    NA        NA  NA        NA   NA
#[2,] -0.7 -7.00 -1.612245   0 0.3469388    1
#[3,] -0.3 -7.00 -1.000000   0 0.0000000    1
#[4,] -0.1 -7.00  0.000000   0 0.0000000    1
#[5,]  0.1 -7.00  0.000000   0 0.0000000    1
#[6,]  0.3 -7.00 -1.000000   0 0.0000000    1
#[7,]  0.5 -7.00 -1.880000   0 0.2800000    1
#[8,]  0.7 -7.00 -1.612245   0 0.3469388    1
#[9,]  1.0 -6.22 -1.880000   0 0.5000000    1

# wave_v4
#              0% 25%       50%       75% 100%
#[1,]   NA     NA  NA        NA        NA   NA
#[2,] -0.7 -1.000   0 0.3469388 0.8367347    1
#[3,] -0.3 -1.000   0 0.0000000 0.5000000    1
#[4,] -0.1 -1.000   0 0.0000000 0.0000000    1
#[5,]  0.1 -1.000   0 0.0000000 0.0000000    1
#[6,]  0.3 -1.000   0 0.0000000 0.5000000    1
#[7,]  0.5 -1.000   0 0.0200000 0.8200000    1
#[8,]  0.7 -1.000   0 0.3469388 0.8367347    1
#[9,]  1.0 -0.805   0 0.5000000 0.8750000    1

# wave_v5
#                  0% 25% 50%       75% 100%
#[1,]   NA         NA  NA  NA        NA   NA
#[2,] -0.7 -0.4693878   0   0 0.3469388    1
#[3,] -0.3 -1.0000000   0   0 0.0000000    1
#[4,] -0.1 -1.0000000   0   0 0.0000000    1
#[5,]  0.1 -1.0000000   0   0 0.0000000    1
#[6,]  0.3 -1.0000000   0   0 0.0000000    1
#[7,]  0.5 -1.0000000   0   0 0.2800000    1
#[8,]  0.7 -0.4693878   0   0 0.3469388    1
#[9,]  1.0 -0.6200000   0   0 0.5000000    1


# wave_v6
#           0% 25% 50%       75% 100%
#[1,]   NA NA  NA  NA        NA   NA
#[2,] -0.7  0   0   0 0.8367347    1
#[3,] -0.3  0   0   0 0.0000000    1
#[4,] -0.1  0   0   0 0.0000000    1
#[5,]  0.1  0   0   0 0.0000000    1
#[6,]  0.3  0   0   0 0.0000000    1
#[7,]  0.5  0   0   0 0.8200000    1
#[8,]  0.7  0   0   0 0.8367347    1
#[9,]  1.0  0   0   0 0.8750000    1
